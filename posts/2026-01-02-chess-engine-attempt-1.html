<html>
<head>
  <title>Attempt 1 of making chess engine</title>
  <link rel="stylesheet" type="text/css" href="style.css"/>
    <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-AMS-MML_SVG"></script>
    <script type="text/javascript">
        window.MathJax = {
            tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]},
            TeX: {
                extensions: ["AMScd.js"]
            },
            "HTML-CSS": { scale: 100 }
        };
    </script>
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-1450977-3"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments)};
    gtag('js', new Date());
  
    gtag('config', 'UA-1450977-3');
  </script>

   <style>
        .container {
            padding: 40px;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 400px;
        }
       table {
            border-collapse: collapse;
            width: 100%;
            margin: 20px 0;
        }
        th, td {
            border: 1px solid black;
            padding: 10px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
        }
    </style>

</head>

<body>
<h1>Making a chess engine - Part 1</h1>

<p>
<h2>Links</h2>
<b>Video:</b>
<iframe width="560" height="315" src="https://www.youtube.com/embed/VhMhaMiwhCc" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>

<br/>
<b>Slides: </b><a href="https://docs.google.com/presentation/d/14wBcLFRJmmfgl2XrGPdNkL3MUQAwzn7I1SL6pt1QTzQ/">Here</a>
<br/>
<b>Code: </b><a href="https://github.com/thevivekpandey/chess/tree/main/attempt_01">Here</a> All the code is in attempt1 directory.
<br/>
</p>

<h2>Quick details on model and training</h2>
<p>
18 plane board encoding (12 for pieces, 4 for castling rights, 1 for move, 1 for en passant pawn). A total of ~10M weights in the model
(conv and resnet layers). Huber loss. Only value head is trained. Game is played with full 3 ply search.
</p>

<p>
Trained on 3.6M evals from stockfish (all types of games - weak and strong) with 400K evals in each of the ranges $(-\infty, -10), [-10, -5], [-5, -3], [-3, -1], [-1, +1], [+1, +3], [+3, +5], [+5, +10], [+10, +\infty]$
Validation data is of size 360K, with equal proportion of data in each of the above nine ranges. In the end "within 1 accuracy" (fraction of validation points where predicted value is less than 1 away from ground truth) is ~55%.
</p>

<h2>Performance</h2>
<p>
Wins against stockfish skill levels 0 and 1 (5-0 and 3-1 respectively). Loses against level 2. Implied ELO rating - 1450.
</p>

<h2>Sample games</h2>
<a href="https://lichess.org/j5hlVY2A">Game 1: NN vs Stockfish (skill level 2) 0-1</a> (Stockfish wins)
<br>
<a href="https://lichess.org/nEd62Unn">Game 2: Stockfish (skill level 2) vs NN 0-1</a> (NN wins)
<br>
<a href="https://lichess.org/4gtS4VKP">Game 3: NN vs Stockfish (skill level 2) 1-0</a> (NN wins)
<br>
<a href="https://lichess.org/vpmIU4cq">Game 4: Stockfish (skill level 2) vs NN 0-1</a> (NN wins)
</body>
</html>
